<div class="cache-refresher-settings">
    <div class="inline-drawer">
        <div class="inline-drawer-toggle inline-drawer-header">
            <b>Cache Refresher</b>
            <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
        </div>
        <div class="inline-drawer-content">
            <div class="cache-refresher-block">
                <div class="cache-refresher-description">
                    <p>
                        Automatically keeps your LLM's cache warm by sending periodic minimal requests.
                        This prevents cache expiration and reduces API costs, especially for Claude models.
                    </p>
                </div>

                <!-- Enable Toggle -->
                <div class="cache-refresher-row">
                    <label class="checkbox_label" for="cache_refresh_enabled">
                        <input type="checkbox" id="cache_refresh_enabled" />
                        <span>Enable Cache Refresh</span>
                    </label>
                </div>

                <!-- Refresh Interval -->
                <div class="cache-refresher-row">
                    <label for="cache_refresh_interval">
                        <span>Refresh Interval (seconds)</span>
                        <small>Time between cache refresh requests (30-600)</small>
                    </label>
                    <input 
                        type="number" 
                        id="cache_refresh_interval" 
                        min="30" 
                        max="600" 
                        step="10"
                        class="text_pole" 
                    />
                </div>

                <!-- Max Refreshes -->
                <div class="cache-refresher-row">
                    <label for="cache_refresh_max">
                        <span>Max Refreshes per Message</span>
                        <small>Maximum refresh requests after each message (1-20)</small>
                    </label>
                    <input 
                        type="number" 
                        id="cache_refresh_max" 
                        min="1" 
                        max="20" 
                        step="1"
                        class="text_pole" 
                    />
                </div>

                <hr class="cache-refresher-divider" />

                <!-- UI Options -->
                <div class="cache-refresher-row">
                    <label class="checkbox_label" for="cache_refresh_notifications">
                        <input type="checkbox" id="cache_refresh_notifications" />
                        <span>Show Notifications</span>
                    </label>
                </div>

                <div class="cache-refresher-row">
                    <label class="checkbox_label" for="cache_refresh_status">
                        <input type="checkbox" id="cache_refresh_status" />
                        <span>Show Status Indicator</span>
                    </label>
                </div>

                <div class="cache-refresher-row">
                    <label class="checkbox_label" for="cache_refresh_debug">
                        <input type="checkbox" id="cache_refresh_debug" />
                        <span>Debug Mode</span>
                    </label>
                </div>

                <hr class="cache-refresher-divider" />

                <!-- Manual Control -->
                <div class="cache-refresher-row">
                    <button id="cache_refresh_stop" class="menu_button">
                        <i class="fa-solid fa-stop"></i>
                        <span>Stop Timer</span>
                    </button>
                </div>

                <!-- Info Section -->
                <div class="cache-refresher-info">
                    <h4>How it works:</h4>
                    <ul>
                        <li>After you receive an AI response, the extension starts a countdown timer.</li>
                        <li>When the timer expires, it sends a minimal request to keep the cache alive.</li>
                        <li>This continues until the maximum refresh count is reached.</li>
                        <li>Changing or leaving the conversation stops the timer.</li>
                    </ul>
                    <h4>Recommended Settings for Claude:</h4>
                    <ul>
                        <li><strong>Interval:</strong> 240 seconds (4 minutes) - Cache expires at 5 minutes</li>
                        <li><strong>Max Refreshes:</strong> 5-10 depending on your break duration</li>
                    </ul>
                    <h4>Requirements:</h4>
                    <ul>
                        <li>Chat Completion mode enabled</li>
                        <li>Claude caching settings configured in config.yaml</li>
                        <li>For OpenRouter: system prompt caching is always enabled</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
</div>
