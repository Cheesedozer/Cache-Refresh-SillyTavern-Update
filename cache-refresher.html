<div class="cache-refresher-settings">
    <div class="inline-drawer">
        <div class="inline-drawer-toggle inline-drawer-header">
            <b>Cache Refresher</b>
            <div class="inline-drawer-icon fa-solid fa-circle-chevron-down down"></div>
        </div>
        <div class="inline-drawer-content">
            <!-- Main Settings Section -->
            <div class="cache-section">
                <h4 class="cache-section-title">üîÑ Cache Refresher</h4>
                <p class="cache-section-description">
                    Automatically keeps your LLM cache warm by sending periodic minimal requests,
                    preventing expensive cache misses when you pause between messages.
                </p>

                <div class="cache-setting">
                    <label class="checkbox_label" for="cache_refresh_enabled">
                        <input type="checkbox" id="cache_refresh_enabled" />
                        <span>Enable Cache Refresher</span>
                    </label>
                </div>

                <div class="cache-setting">
                    <label for="cache_refresh_interval">Refresh Interval (seconds)</label>
                    <input type="number"
                           id="cache_refresh_interval"
                           class="text_pole"
                           min="30"
                           max="600"
                           step="10"
                           title="Time between cache refresh requests (30-600 seconds)" />
                    <small class="cache-hint">Recommended: 240s for Claude's 5-minute cache TTL</small>
                </div>

                <div class="cache-setting">
                    <label for="cache_refresh_max">Maximum Refreshes</label>
                    <input type="number"
                           id="cache_refresh_max"
                           class="text_pole"
                           min="1"
                           max="20"
                           step="1"
                           title="Maximum number of refresh requests per message (1-20)" />
                    <small class="cache-hint">Limits how many times cache is refreshed after a message</small>
                </div>

                <div class="cache-setting">
                    <label class="checkbox_label" for="cache_refresh_notifications">
                        <input type="checkbox" id="cache_refresh_notifications" />
                        <span>Show Notifications</span>
                    </label>
                </div>

                <div class="cache-setting">
                    <label class="checkbox_label" for="cache_refresh_timer">
                        <input type="checkbox" id="cache_refresh_timer" />
                        <span>Show Floating Timer</span>
                    </label>
                    <small class="cache-hint">Displays a draggable countdown widget</small>
                </div>

                <div class="cache-setting cache-buttons">
                    <button id="cache_refresh_stop" class="menu_button">
                        <i class="fa-solid fa-stop"></i> Stop Timer
                    </button>
                    <button id="cache_refresh_reset_position" class="menu_button">
                        <i class="fa-solid fa-arrows-to-dot"></i> Reset Position
                    </button>
                </div>
            </div>

            <hr class="cache-divider" />

            <!-- Debug Section -->
            <div class="cache-section">
                <h4 class="cache-section-title">üõ†Ô∏è Debug</h4>

                <div class="cache-setting">
                    <label class="checkbox_label" for="cache_refresh_debug">
                        <input type="checkbox" id="cache_refresh_debug" />
                        <span>Enable Debug Logging</span>
                    </label>
                    <small class="cache-hint">Logs detailed info to browser console (F12)</small>
                </div>
            </div>

            <hr class="cache-divider" />

            <!-- Info Section -->
            <div class="cache-section cache-info">
                <h4 class="cache-section-title">‚ÑπÔ∏è How It Works</h4>
                <p>
                    Claude's prompt cache has a <strong>5-minute TTL</strong>. If you pause between messages
                    longer than 5 minutes, the cache expires and you pay full price for tokens that were
                    previously cached.
                </p>
                <p>
                    Cache Refresher sends tiny "ping" requests to keep your cache alive, saving you money
                    on long conversations.
                </p>
                <p class="cache-tips">
                    <strong>Tips for better caching:</strong>
                    <ul>
                        <li>Set <code>cachingAtDepth</code> to 2 in config.yaml</li>
                        <li>Enable <code>enableSystemPromptCache</code> for static prompts</li>
                        <li>Avoid random macros like <code>{{random}}</code> in system prompts</li>
                        <li>Use Chat Completion mode (caching not available for Text Completion)</li>
                    </ul>
                </p>
                <p class="cache-version">
                    Version 3.0.0 ‚Ä¢
                    <a href="https://github.com/Cheesedozer/Cache-Refresh-SillyTavern-Update" target="_blank">GitHub</a>
                </p>
            </div>
        </div>
    </div>
</div>
